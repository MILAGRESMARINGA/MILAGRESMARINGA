(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();function p(){const e=document.querySelectorAll(".choice-button"),t=document.querySelectorAll(".back-button"),r=document.querySelector(".back-to-home-button");e.forEach(a=>{a.addEventListener("click",()=>{const n=a.getAttribute("data-form");s(n)})}),t.forEach(a=>{a.addEventListener("click",()=>{s("home-screen")})}),r&&r.addEventListener("click",()=>{s("home-screen")})}function s(e){document.querySelectorAll(".screen").forEach(a=>{a.classList.remove("active")});const r=document.getElementById(e);r&&setTimeout(()=>{r.classList.add("active")},50)}function u(){s("success-screen"),setTimeout(()=>{s("home-screen")},3e3)}function h(){localStorage.getItem("milagres-data")||y()}function y(){const e={"accept-jesus":[],returning:[],"miracle-testimony":[]};localStorage.setItem("milagres-data",JSON.stringify(e))}function m(e,t){try{const r=JSON.parse(localStorage.getItem("milagres-data"))||y();return Array.isArray(r[e])?r[e].push(t):r[e]=[t],localStorage.setItem("milagres-data",JSON.stringify(r)),!0}catch(r){return console.error("Error saving data to localStorage:",r),!1}}function E(){const e=document.getElementById("accept-jesus-form"),t=document.getElementById("returning-form"),r=document.getElementById("miracle-testimony-form");e&&e.addEventListener("submit",a=>{a.preventDefault();const n=document.getElementById("accept-name"),o=document.getElementById("accept-phone"),c=document.getElementById("accept-city"),d=document.getElementById("accept-country-code").value;v("accept",n,o,c)&&(m("accept-jesus",{name:n.value,phone:`${d} ${o.value}`,city:c.value,date:new Date().toISOString()}),e.reset(),u())}),t&&t.addEventListener("submit",a=>{a.preventDefault();const n=document.getElementById("return-name"),o=document.getElementById("return-phone"),c=document.getElementById("return-city"),d=document.getElementById("return-country-code").value;v("return",n,o,c)&&(m("returning",{name:n.value,phone:`${d} ${o.value}`,city:c.value,date:new Date().toISOString()}),t.reset(),u())}),r&&r.addEventListener("submit",a=>{a.preventDefault();const n=document.getElementById("miracle-type"),o=document.getElementById("miracle-details");S(n,o)&&(m("miracle-testimony",{type:n.value,details:o.value,date:new Date().toISOString()}),r.reset(),u())})}function v(e,t,r,a){let n=!0;return I(t.value)?(g(`${e}-name-error`),l(t)):(f(`${e}-name-error`,"Nome deve conter apenas letras e espaços"),i(t),n=!1),L(r.value)?(g(`${e}-phone-error`),l(r)):(f(`${e}-phone-error`,"Telefone deve conter 10 a 13 dígitos"),i(r),n=!1),B(a.value)?(g(`${e}-city-error`),l(a)):(f(`${e}-city-error`,"Cidade deve conter apenas letras e espaços"),i(a),n=!1),n}function S(e,t){let r=!0;return e.value===""?(i(e),r=!1):l(e),t.value.trim()===""?(i(t),r=!1):l(t),r}function I(e){return/^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$/.test(e)&&e.trim().length>0}function L(e){const t=e.replace(/\D/g,"");return t.length>=10&&t.length<=13}function B(e){return/^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$/.test(e)&&e.trim().length>0}function f(e,t){const r=document.getElementById(e);r&&(r.textContent=t)}function g(e){const t=document.getElementById(e);t&&(t.textContent="")}function i(e){e.classList.add("error"),e.classList.remove("valid"),e.classList.add("shake"),setTimeout(()=>{e.classList.remove("shake")},600)}function l(e){e.classList.remove("error"),e.classList.add("valid")}async function k(){var e;if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("/service-worker.js");console.log("Service Worker registered with scope:",t.scope),t.addEventListener("updatefound",()=>{const r=t.installing;r.addEventListener("statechange",()=>{r.state==="installed"&&navigator.serviceWorker.controller&&b()})})}catch(t){(e=t.message)!=null&&e.includes("Service Workers are not yet supported on StackBlitz")||console.error("Service Worker registration failed:",t)}}function b(){const e=document.createElement("div");e.className="pwa-update-notification",e.innerHTML=`
    <p>Nova versão disponível!</p>
    <button onclick="window.location.reload()">Atualizar agora</button>
  `,document.body.appendChild(e)}document.addEventListener("DOMContentLoaded",()=>{p(),E(),h(),k()});
